<!DOCTYPE html>
<html lang="de">
<head>
	<meta http-equiv="Content-type" content="text/html; charset=utf-8">
	<title>Analysis</title>
	<link rel="stylesheet" href="bootstrap/css/bootstrap.min.css" type="text/css" media="screen" title="no title" charset="utf-8">
	<link rel="stylesheet" href="bootstrap/css/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
	<script type="text/javascript" src="bootstrap/js/jquery.min.js" charset="utf-8"></script>
	<script type="text/javascript" src="bootstrap/js/bootstrap.min.js" charset="utf-8"></script>
	<script type="text/javascript" src="bootstrap/js/jquery.fancybox.pack.js?v=2.1.5"></script>
</head>
<body>
<div class="container">
<h1>Analysis</h1>

<h2>Einleitung</h2>

<h2>Phase 1</h2>

<p>Um mit der App etwas vertraut zu werden habe ich mich dazu entschlossen `ab` ein paar Tests mit unterschiedlichen App- und Datenbank-Servern durchzuführen. Um halbwegs realistische Werte zu bekommen habe ich die Server detached und im Production-Environment gestartet.</p>

<p>Um die Tests innerhalb einer erträglichen Wartezeit durchführen zu können habe ich `ab` mit einer Concurrency von 1 und mit 10 Requests durchgeführt.</p>

<div class="row">
	<a class="fancybox" href="images/phase_01.png"><img src="images/phase_01.png" alt="Ergebnisse Phase 1" class="img-polaroid span4"></a>
</div>

<p>Auf der y-Achse sind die durchschnittlichen Requests pro Sekunde aufgetragen. Wie sofort ersichtlich ist, gibt es bei den Webservern nur minimale Abweichungen, währen bei den Datenbank-Servern gravierende Unterschiede bestehen: SQLite ist weit abgeschlagen.</p>


<h2>Phase 2</h2>

<p>Im nächste Schritt habe ich mir ein Script geschrieben (in <code>analysis/script/benchmark.rb</code>), das den Benchmarking Prozess so gut wie möglich automatisieren soll. Ich habe mich dazu entschlossen folgende Seiten zu benchmarken:</p>

<ul>
	<li>Home (mit und ohne eingeloggtem User)</li>
	<li>Ein User mit keinen Rezepten (mit und ohne eingeloggtem User)</li>
	<li>Ein User mit vielen Rezepten (mit und ohne eingeloggtem User)</li>
	<li>Ein Rezept mit keinen Zutaten (mit und ohne eingeloggtem User)</li>
	<li>Ein Rezept mit vielen Zutaten (mit und ohne eingeloggtem User)</li>
</ul>

<p>Die Konfiguration für diesen Test schaut folgendermaßen aus:</p>

<ul>
	<li>App-Server: Unicorn</li>
	<li>Datenbank: SQLite</li>
</ul>

<p><em>Um die Graphen einer entsprechenden Testreihe anzuzeigen, einfach auf die Überschrift klicken.</em></p>

<h3><a onclick="$('#phase_02_home').toggle()">Home</a></h3>

<div id="phase_02_home" style="display:none">
<p><strong>Ohne eingeloggtem User</strong></p>

<div class="row">
	<a class="fancybox" href="raw_data/phase_02/02_home_average_reply_rate.svg"><img src="raw_data/phase_02/02_home_average_reply_rate.svg" class="img-polaroid span3"></a>
	<a class="fancybox" href="raw_data/phase_02/02_home_average_response_time.svg"><img src="raw_data/phase_02/02_home_average_response_time.svg" class="img-polaroid span3"></a>
	<a class="fancybox" href="raw_data/phase_02/02_home_errors.svg"><img src="raw_data/phase_02/02_home_errors.svg" class="img-polaroid span3"></a>
</div>

<p><strong>Mit eingeloggtem User</strong></p>

<div class="row">
	<a class="fancybox" href="raw_data/phase_02/01_home_with_auth_average_reply_rate.svg"><img src="raw_data/phase_02/01_home_with_auth_average_reply_rate.svg" class="img-polaroid span3"></a>
	<a class="fancybox" href="raw_data/phase_02/01_home_with_auth_average_response_time.svg"><img src="raw_data/phase_02/01_home_with_auth_average_response_time.svg" class="img-polaroid span3"></a>
	<a class="fancybox" href="raw_data/phase_02/01_home_with_auth_errors.svg"><img src="raw_data/phase_02/01_home_with_auth_errors.svg" class="img-polaroid span3"></a>
</div>
</div>

<h3><a onclick="$('#phase_02_user_light').toggle()">User mit wenigen Rezepten</a></h3>

<div id="phase_02_user_light" style="display:none">
<p><strong>Ohne eingeloggtem User</strong></p>

<div class="row">
	<a class="fancybox" href="raw_data/phase_02/03_user_light_average_reply_rate.svg"><img src="raw_data/phase_02/03_user_light_average_reply_rate.svg" class="img-polaroid span3"></a>
	<a class="fancybox" href="raw_data/phase_02/03_user_light_average_response_time.svg"><img src="raw_data/phase_02/03_user_light_average_response_time.svg" class="img-polaroid span3"></a>
	<a class="fancybox" href="raw_data/phase_02/03_user_light_errors.svg"><img src="raw_data/phase_02/03_user_light_errors.svg" class="img-polaroid span3"></a>
</div>

<p><strong>Mit eingeloggtem User</strong></p>

<div class="row">
	<a class="fancybox" href="raw_data/phase_02/04_user_light_with_auth_average_reply_rate.svg"><img src="raw_data/phase_02/04_user_light_with_auth_average_reply_rate.svg" class="img-polaroid span3"></a>
	<a class="fancybox" href="raw_data/phase_02/04_user_light_with_auth_average_response_time.svg"><img src="raw_data/phase_02/04_user_light_with_auth_average_response_time.svg" class="img-polaroid span3"></a>
	<a class="fancybox" href="raw_data/phase_02/04_user_light_with_auth_errors.svg"><img src="raw_data/phase_02/04_user_light_with_auth_errors.svg" class="img-polaroid span3"></a>
</div>
</div>

<h3><a onclick="$('#phase_02_user_heavy').toggle()">User mit vielen Rezepten</a></h3>

<div id="phase_02_user_heavy" style="display:none">
<p><strong>Ohne eingeloggtem User</strong></p>

<div class="row">
	<a class="fancybox" href="raw_data/phase_02/05_user_heavy_average_reply_rate.svg"><img src="raw_data/phase_02/05_user_heavy_average_reply_rate.svg" class="img-polaroid span3"></a>
	<a class="fancybox" href="raw_data/phase_02/05_user_heavy_average_response_time.svg"><img src="raw_data/phase_02/05_user_heavy_average_response_time.svg" class="img-polaroid span3"></a>
	<a class="fancybox" href="raw_data/phase_02/05_user_heavy_errors.svg"><img src="raw_data/phase_02/05_user_heavy_errors.svg" class="img-polaroid span3"></a>
</div>

<p><strong>Mit eingeloggtem User</strong></p>

<div class="row">
	<a class="fancybox" href="raw_data/phase_02/06_user_heavy_with_auth_average_reply_rate.svg"><img src="raw_data/phase_02/06_user_heavy_with_auth_average_reply_rate.svg" class="img-polaroid span3"></a>
	<a class="fancybox" href="raw_data/phase_02/06_user_heavy_with_auth_average_response_time.svg"><img src="raw_data/phase_02/06_user_heavy_with_auth_average_response_time.svg" class="img-polaroid span3"></a>
	<a class="fancybox" href="raw_data/phase_02/06_user_heavy_with_auth_errors.svg"><img src="raw_data/phase_02/06_user_heavy_with_auth_errors.svg" class="img-polaroid span3"></a>
</div>
</div>

<h3><a onclick="$('#phase_02_recipe_light').toggle()">Rezepte mit wenigen Zutaten</a></h3>

<div id="phase_02_recipe_light" style="display:none">
<p><strong>Ohne eingeloggtem User</strong></p>

<div class="row">
	<a class="fancybox" href="raw_data/phase_02/07_recipe_light_average_reply_rate.svg"><img src="raw_data/phase_02/07_recipe_light_average_reply_rate.svg" class="img-polaroid span3"></a>
	<a class="fancybox" href="raw_data/phase_02/07_recipe_light_average_response_time.svg"><img src="raw_data/phase_02/07_recipe_light_average_response_time.svg" class="img-polaroid span3"></a>
	<a class="fancybox" href="raw_data/phase_02/07_recipe_light_errors.svg"><img src="raw_data/phase_02/07_recipe_light_errors.svg" class="img-polaroid span3"></a>
</div>

<p><strong>Mit eingeloggtem User</strong></p>

<div class="row">
	<a class="fancybox" href="raw_data/phase_02/08_recipe_light_with_auth_average_reply_rate.svg"><img src="raw_data/phase_02/08_recipe_light_with_auth_average_reply_rate.svg" class="img-polaroid span3"></a>
	<a class="fancybox" href="raw_data/phase_02/08_recipe_light_with_auth_average_response_time.svg"><img src="raw_data/phase_02/08_recipe_light_with_auth_average_response_time.svg" class="img-polaroid span3"></a>
	<a class="fancybox" href="raw_data/phase_02/08_recipe_light_with_auth_errors.svg"><img src="raw_data/phase_02/08_recipe_light_with_auth_errors.svg" class="img-polaroid span3"></a>
</div>
</div>

<h3><a onclick="$('#phase_02_recipe_heavy').toggle()">Rezepte mit vielen Zutaten</a></h3>

<div id="phase_02_recipe_heavy" style="display:none">
<p><strong>Ohne eingeloggtem User</strong></p>

<div class="row">
	<a class="fancybox" href="raw_data/phase_02/09_recipe_heavy_average_reply_rate.svg"><img src="raw_data/phase_02/09_recipe_heavy_average_reply_rate.svg" class="img-polaroid span3"></a>
	<a class="fancybox" href="raw_data/phase_02/09_recipe_heavy_average_response_time.svg"><img src="raw_data/phase_02/09_recipe_heavy_average_response_time.svg" class="img-polaroid span3"></a>
	<a class="fancybox" href="raw_data/phase_02/09_recipe_heavy_errors.svg"><img src="raw_data/phase_02/09_recipe_heavy_errors.svg" class="img-polaroid span3"></a>
</div>

<p><strong>Mit eingeloggtem User</strong></p>

<div class="row">
	<a class="fancybox" href="raw_data/phase_02/10_recipe_heavy_with_auth_average_reply_rate.svg"><img src="raw_data/phase_02/10_recipe_heavy_with_auth_average_reply_rate.svg" class="img-polaroid span3"></a>
	<a class="fancybox" href="raw_data/phase_02/10_recipe_heavy_with_auth_average_response_time.svg"><img src="raw_data/phase_02/10_recipe_heavy_with_auth_average_response_time.svg" class="img-polaroid span3"></a>
	<a class="fancybox" href="raw_data/phase_02/10_recipe_heavy_with_auth_errors.svg"><img src="raw_data/phase_02/10_recipe_heavy_with_auth_errors.svg" class="img-polaroid span3"></a>
</div>
</div>

<h3>Fazit</h3>

<p>Der Sinn dieses Durchlaufs war es für alle relevanten Seite festzustellen, wie sie performen. Da die Ausgangs-Applikation das sehr langsame SQLite verwendet, sind alle Tests gescheitert &ndash; ensprechend langweilig sind die daraus resultierenden Graphen. Im nächsten Schritt werde ich also versuchen MySQL zu verwenden und eine erneute Messung durchzuführen. Das Ziel der nächsten Phase wird sein Benchmarks zu generieren, die zumindest bei geringer Concurrency nicht in 100% Fehlern resultieren.</p>

</div><!-- /.container -->

<script type="text/javascript">
	$(document).ready(function() {
		$(".fancybox").fancybox();
	});
</script>
</body>
</html>
